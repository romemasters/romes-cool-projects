---
// src/pages/index.astro

import fs from 'fs';
import path from 'path';

const user = "romemasters";
const repo = "romes-cool-projects";
const branch = "main";
const textsDir = path.resolve('public', 'texts');
const files = fs.existsSync(textsDir) ? fs.readdirSync(textsDir) : [];
const logoUrl = "https://raw.githubusercontent.com/romemasters/romes-cool-projects/refs/heads/main/public/468-4684000_png-file-svg-easy-storage-icon-transparent-png.png";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Code Unit · Personal Raw Text Files</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
      body {
        font-family: 'Segoe UI', Arial, sans-serif;
        margin: 0;
        background: #f6f8fa;
        color: #22223b;
      }
      header {
        background: #22223b;
        color: #fff;
        padding: 2.2rem 0 1.4rem 0;
        text-align: center;
        border-bottom: 3px solid #4a4e69;
      }
      .logo {
        width: 82px;
        height: 82px;
        object-fit: contain;
        background: #fff;
        border-radius: 50%;
        margin-bottom: 1rem;
        box-shadow: 0 2px 10px #4a4e6940;
      }
      h1 {
        margin: 0 0 0.4rem 0;
        font-size: 2.2rem;
        letter-spacing: 0.5px;
      }
      .desc {
        color: #b2adc7;
        margin-bottom: 2rem;
        font-size: 1.1rem;
        line-height: 1.6;
      }
      .container {
        max-width: 580px;
        margin: 2.5rem auto;
        padding: 2rem;
        background: #fff;
        border-radius: 1.2rem;
        box-shadow: 0 6px 32px 0 #22223b14;
      }
      h2 {
        font-size: 1.3rem;
        color: #4a4e69;
        margin-top: 0;
        margin-bottom: 0.8rem;
      }
      .file-list {
        list-style: none;
        padding: 0;
        margin: 1.5rem 0 1rem 0;
      }
      .file-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #f2e9e4;
        border-radius: 0.6rem;
        padding: 0.8rem 1.1rem;
        margin: 0.6rem 0;
        box-shadow: 0 1px 6px #c9ada720;
        transition: background 0.15s;
      }
      .file-row:hover {
        background: #e7d6cb;
      }
      .file-link {
        color: #22223b;
        text-decoration: none;
        font-weight: 500;
        font-size: 1.07em;
        flex: 1;
        transition: color 0.18s;
      }
      .file-link:hover {
        color: #4a4e69;
        text-decoration: underline;
      }
      .edit-btn {
        background: none;
        border: none;
        outline: none;
        cursor: pointer;
        margin-left: 0.9rem;
        padding: 0.2rem 0.3rem;
        border-radius: 5px;
        transition: background 0.18s;
        display: flex;
        align-items: center;
      }
      .edit-btn:hover {
        background: #dad2e9;
      }
      .edit-icon {
        width: 21px;
        height: 21px;
        display: block;
        fill: #4a4e69;
      }
      nav {
        margin: 1.8rem 0 0 0;
        text-align: center;
      }
      nav a {
        color: #4a4e69;
        margin: 0 1.1rem;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.05em;
        border-bottom: 2px solid transparent;
        transition: color 0.16s, border-color 0.16s;
      }
      nav a:hover {
        color: #22223b;
        border-color: #c9ada7;
      }
      @media (max-width: 700px) {
        .container { padding: 1rem; }
        .logo { width: 60px; height: 60px; }
      }
    </style>
  </head>
  <body>
    <header>
      <img src={logoUrl} class="logo" alt="Code Unit Logo" />
      <h1>Personal Code Unit</h1>
      <div class="desc">
        Welcome to my own cloud locker for scripts and plain text files.<br/>
        <b>Note:</b> This is a personal code storage site! If you want a similar setup, feel free to <a href="https://github.com/{user}/{repo}" style="color:#f2e9e4;font-weight:600;">clone the repo</a> and make your own.
      </div>
    </header>
    <div class="container">
      <h2>My Stored Files</h2>
      {files.length > 0 ? (
        <ul class="file-list">
          {files.map(file => (
            <li class="file-row">
              <a class="file-link" href={`/texts/${file}`} target="_blank" rel="noopener">
                {file}
              </a>
              <a
                class="edit-btn"
                href={`https://github.com/${user}/${repo}/edit/${branch}/public/texts/${file}`}
                title="Edit on GitHub"
                target="_blank"
                rel="noopener"
              >
                <svg class="edit-icon" viewBox="0 0 20 20">
                  <path d="M14.85 2.15a2.121 2.121 0 0 1 3 3l-9.04 9.04a1 1 0 0 1-.47.26l-4.24 1.06a.5.5 0 0 1-.61-.61l1.06-4.24a1 1 0 0 1 .26-.47l9.04-9.04zm2.12.88a1.121 1.121 0 0 0-1.59 0l-1.13 1.13 1.59 1.59 1.13-1.13a1.121 1.121 0 0 0 0-1.59zM13.07 5.93l-8.28 8.28-.64 2.57 2.57-.64 8.28-8.28-2.13-2.13z"></path>
                </svg>
              </a>
            </li>
          ))}
        </ul>
      ) : (
        <div style="color:#c9ada7;">No files yet! Add some text files to <code>public/texts/</code> in the repo.</div>
      )}
      <nav>
        <a href="/about">About</a>
        <a href={`https://github.com/${user}/${repo}`} target="_blank" rel="noopener">GitHub</a>
      </nav>
    </div>
    <footer style="text-align:center; color:#c9ada7; margin:3rem 0 1rem 0; font-size:0.97em;">
      &copy; {new Date().getFullYear()} {user} · Code Unit
    </footer>
  </body>
</html>
